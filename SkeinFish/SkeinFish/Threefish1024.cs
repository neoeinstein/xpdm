using System;

namespace SkeinFish
{
    internal class Threefish1024 : ThreefishCipher
    {
        const int CIPHER_SIZE = 1024;
        const int CIPHER_QWORDS = CIPHER_SIZE / 64;
        const int EXPANDED_KEY_SIZE = CIPHER_QWORDS + 1;

        public Threefish1024()
        {
            // Create the expanded key array
            m_ExpandedKey = new ulong[EXPANDED_KEY_SIZE];
        }

        public override void Encrypt(ulong[] input, ulong[] output)
        {
            // Cache the block, key, and tweak
            ulong b0 = input[0], b1 = input[1],
                  b2 = input[2], b3 = input[3],
                  b4 = input[4], b5 = input[5],
                  b6 = input[6], b7 = input[7],
                  b8 = input[8], b9 = input[9],
                  b10 = input[10], b11 = input[11],
                  b12 = input[12], b13 = input[13],
                  b14 = input[14], b15 = input[15];
            ulong k0 = m_ExpandedKey[0], k1 = m_ExpandedKey[1],
                  k2 = m_ExpandedKey[2], k3 = m_ExpandedKey[3],
                  k4 = m_ExpandedKey[4], k5 = m_ExpandedKey[5],
                  k6 = m_ExpandedKey[6], k7 = m_ExpandedKey[7],
                  k8 = m_ExpandedKey[8], k9 = m_ExpandedKey[9],
                  k10 = m_ExpandedKey[10], k11 = m_ExpandedKey[11],
                  k12 = m_ExpandedKey[12], k13 = m_ExpandedKey[13],
                  k14 = m_ExpandedKey[14], k15 = m_ExpandedKey[15],
                  k16 = m_ExpandedKey[16];
            ulong t0 = m_ExpandedTweak[0], t1 = m_ExpandedTweak[1],
                  t2 = m_ExpandedTweak[2];


            Mix(ref b0, ref b1, 55, k0, k1);
            Mix(ref b2, ref b3, 43, k2, k3);
            Mix(ref b4, ref b5, 37, k4, k5);
            Mix(ref b6, ref b7, 40, k6, k7);
            Mix(ref b8, ref b9, 16, k8, k9);
            Mix(ref b10, ref b11, 22, k10, k11);
            Mix(ref b12, ref b13, 38, k12, k13 + t0);
            Mix(ref b14, ref b15, 12, k14 + t1, k15);
            Mix(ref b0, ref b9, 25);
            Mix(ref b2, ref b13, 25);
            Mix(ref b6, ref b11, 46);
            Mix(ref b4, ref b15, 13);
            Mix(ref b10, ref b7, 14);
            Mix(ref b12, ref b3, 13);
            Mix(ref b14, ref b5, 52);
            Mix(ref b8, ref b1, 57);
            Mix(ref b0, ref b7, 33);
            Mix(ref b2, ref b5, 8);
            Mix(ref b4, ref b3, 18);
            Mix(ref b6, ref b1, 57);
            Mix(ref b12, ref b15, 21);
            Mix(ref b14, ref b13, 12);
            Mix(ref b8, ref b11, 32);
            Mix(ref b10, ref b9, 54);
            Mix(ref b0, ref b15, 34);
            Mix(ref b2, ref b11, 43);
            Mix(ref b6, ref b13, 25);
            Mix(ref b4, ref b9, 60);
            Mix(ref b14, ref b1, 44);
            Mix(ref b8, ref b5, 9);
            Mix(ref b10, ref b3, 59);
            Mix(ref b12, ref b7, 34);
            Mix(ref b0, ref b1, 28, k1, k2);
            Mix(ref b2, ref b3, 7, k3, k4);
            Mix(ref b4, ref b5, 47, k5, k6);
            Mix(ref b6, ref b7, 48, k7, k8);
            Mix(ref b8, ref b9, 51, k9, k10);
            Mix(ref b10, ref b11, 9, k11, k12);
            Mix(ref b12, ref b13, 35, k13, k14 + t1);
            Mix(ref b14, ref b15, 41, k15 + t2, k16 + 1);
            Mix(ref b0, ref b9, 17);
            Mix(ref b2, ref b13, 6);
            Mix(ref b6, ref b11, 18);
            Mix(ref b4, ref b15, 25);
            Mix(ref b10, ref b7, 43);
            Mix(ref b12, ref b3, 42);
            Mix(ref b14, ref b5, 40);
            Mix(ref b8, ref b1, 15);
            Mix(ref b0, ref b7, 58);
            Mix(ref b2, ref b5, 7);
            Mix(ref b4, ref b3, 32);
            Mix(ref b6, ref b1, 45);
            Mix(ref b12, ref b15, 19);
            Mix(ref b14, ref b13, 18);
            Mix(ref b8, ref b11, 2);
            Mix(ref b10, ref b9, 56);
            Mix(ref b0, ref b15, 47);
            Mix(ref b2, ref b11, 49);
            Mix(ref b6, ref b13, 27);
            Mix(ref b4, ref b9, 58);
            Mix(ref b14, ref b1, 37);
            Mix(ref b8, ref b5, 48);
            Mix(ref b10, ref b3, 53);
            Mix(ref b12, ref b7, 56);
            Mix(ref b0, ref b1, 55, k2, k3);
            Mix(ref b2, ref b3, 43, k4, k5);
            Mix(ref b4, ref b5, 37, k6, k7);
            Mix(ref b6, ref b7, 40, k8, k9);
            Mix(ref b8, ref b9, 16, k10, k11);
            Mix(ref b10, ref b11, 22, k12, k13);
            Mix(ref b12, ref b13, 38, k14, k15 + t2);
            Mix(ref b14, ref b15, 12, k16 + t0, k0 + 2);
            Mix(ref b0, ref b9, 25);
            Mix(ref b2, ref b13, 25);
            Mix(ref b6, ref b11, 46);
            Mix(ref b4, ref b15, 13);
            Mix(ref b10, ref b7, 14);
            Mix(ref b12, ref b3, 13);
            Mix(ref b14, ref b5, 52);
            Mix(ref b8, ref b1, 57);
            Mix(ref b0, ref b7, 33);
            Mix(ref b2, ref b5, 8);
            Mix(ref b4, ref b3, 18);
            Mix(ref b6, ref b1, 57);
            Mix(ref b12, ref b15, 21);
            Mix(ref b14, ref b13, 12);
            Mix(ref b8, ref b11, 32);
            Mix(ref b10, ref b9, 54);
            Mix(ref b0, ref b15, 34);
            Mix(ref b2, ref b11, 43);
            Mix(ref b6, ref b13, 25);
            Mix(ref b4, ref b9, 60);
            Mix(ref b14, ref b1, 44);
            Mix(ref b8, ref b5, 9);
            Mix(ref b10, ref b3, 59);
            Mix(ref b12, ref b7, 34);
            Mix(ref b0, ref b1, 28, k3, k4);
            Mix(ref b2, ref b3, 7, k5, k6);
            Mix(ref b4, ref b5, 47, k7, k8);
            Mix(ref b6, ref b7, 48, k9, k10);
            Mix(ref b8, ref b9, 51, k11, k12);
            Mix(ref b10, ref b11, 9, k13, k14);
            Mix(ref b12, ref b13, 35, k15, k16 + t0);
            Mix(ref b14, ref b15, 41, k0 + t1, k1 + 3);
            Mix(ref b0, ref b9, 17);
            Mix(ref b2, ref b13, 6);
            Mix(ref b6, ref b11, 18);
            Mix(ref b4, ref b15, 25);
            Mix(ref b10, ref b7, 43);
            Mix(ref b12, ref b3, 42);
            Mix(ref b14, ref b5, 40);
            Mix(ref b8, ref b1, 15);
            Mix(ref b0, ref b7, 58);
            Mix(ref b2, ref b5, 7);
            Mix(ref b4, ref b3, 32);
            Mix(ref b6, ref b1, 45);
            Mix(ref b12, ref b15, 19);
            Mix(ref b14, ref b13, 18);
            Mix(ref b8, ref b11, 2);
            Mix(ref b10, ref b9, 56);
            Mix(ref b0, ref b15, 47);
            Mix(ref b2, ref b11, 49);
            Mix(ref b6, ref b13, 27);
            Mix(ref b4, ref b9, 58);
            Mix(ref b14, ref b1, 37);
            Mix(ref b8, ref b5, 48);
            Mix(ref b10, ref b3, 53);
            Mix(ref b12, ref b7, 56);
            Mix(ref b0, ref b1, 55, k4, k5);
            Mix(ref b2, ref b3, 43, k6, k7);
            Mix(ref b4, ref b5, 37, k8, k9);
            Mix(ref b6, ref b7, 40, k10, k11);
            Mix(ref b8, ref b9, 16, k12, k13);
            Mix(ref b10, ref b11, 22, k14, k15);
            Mix(ref b12, ref b13, 38, k16, k0 + t1);
            Mix(ref b14, ref b15, 12, k1 + t2, k2 + 4);
            Mix(ref b0, ref b9, 25);
            Mix(ref b2, ref b13, 25);
            Mix(ref b6, ref b11, 46);
            Mix(ref b4, ref b15, 13);
            Mix(ref b10, ref b7, 14);
            Mix(ref b12, ref b3, 13);
            Mix(ref b14, ref b5, 52);
            Mix(ref b8, ref b1, 57);
            Mix(ref b0, ref b7, 33);
            Mix(ref b2, ref b5, 8);
            Mix(ref b4, ref b3, 18);
            Mix(ref b6, ref b1, 57);
            Mix(ref b12, ref b15, 21);
            Mix(ref b14, ref b13, 12);
            Mix(ref b8, ref b11, 32);
            Mix(ref b10, ref b9, 54);
            Mix(ref b0, ref b15, 34);
            Mix(ref b2, ref b11, 43);
            Mix(ref b6, ref b13, 25);
            Mix(ref b4, ref b9, 60);
            Mix(ref b14, ref b1, 44);
            Mix(ref b8, ref b5, 9);
            Mix(ref b10, ref b3, 59);
            Mix(ref b12, ref b7, 34);
            Mix(ref b0, ref b1, 28, k5, k6);
            Mix(ref b2, ref b3, 7, k7, k8);
            Mix(ref b4, ref b5, 47, k9, k10);
            Mix(ref b6, ref b7, 48, k11, k12);
            Mix(ref b8, ref b9, 51, k13, k14);
            Mix(ref b10, ref b11, 9, k15, k16);
            Mix(ref b12, ref b13, 35, k0, k1 + t2);
            Mix(ref b14, ref b15, 41, k2 + t0, k3 + 5);
            Mix(ref b0, ref b9, 17);
            Mix(ref b2, ref b13, 6);
            Mix(ref b6, ref b11, 18);
            Mix(ref b4, ref b15, 25);
            Mix(ref b10, ref b7, 43);
            Mix(ref b12, ref b3, 42);
            Mix(ref b14, ref b5, 40);
            Mix(ref b8, ref b1, 15);
            Mix(ref b0, ref b7, 58);
            Mix(ref b2, ref b5, 7);
            Mix(ref b4, ref b3, 32);
            Mix(ref b6, ref b1, 45);
            Mix(ref b12, ref b15, 19);
            Mix(ref b14, ref b13, 18);
            Mix(ref b8, ref b11, 2);
            Mix(ref b10, ref b9, 56);
            Mix(ref b0, ref b15, 47);
            Mix(ref b2, ref b11, 49);
            Mix(ref b6, ref b13, 27);
            Mix(ref b4, ref b9, 58);
            Mix(ref b14, ref b1, 37);
            Mix(ref b8, ref b5, 48);
            Mix(ref b10, ref b3, 53);
            Mix(ref b12, ref b7, 56);
            Mix(ref b0, ref b1, 55, k6, k7);
            Mix(ref b2, ref b3, 43, k8, k9);
            Mix(ref b4, ref b5, 37, k10, k11);
            Mix(ref b6, ref b7, 40, k12, k13);
            Mix(ref b8, ref b9, 16, k14, k15);
            Mix(ref b10, ref b11, 22, k16, k0);
            Mix(ref b12, ref b13, 38, k1, k2 + t0);
            Mix(ref b14, ref b15, 12, k3 + t1, k4 + 6);
            Mix(ref b0, ref b9, 25);
            Mix(ref b2, ref b13, 25);
            Mix(ref b6, ref b11, 46);
            Mix(ref b4, ref b15, 13);
            Mix(ref b10, ref b7, 14);
            Mix(ref b12, ref b3, 13);
            Mix(ref b14, ref b5, 52);
            Mix(ref b8, ref b1, 57);
            Mix(ref b0, ref b7, 33);
            Mix(ref b2, ref b5, 8);
            Mix(ref b4, ref b3, 18);
            Mix(ref b6, ref b1, 57);
            Mix(ref b12, ref b15, 21);
            Mix(ref b14, ref b13, 12);
            Mix(ref b8, ref b11, 32);
            Mix(ref b10, ref b9, 54);
            Mix(ref b0, ref b15, 34);
            Mix(ref b2, ref b11, 43);
            Mix(ref b6, ref b13, 25);
            Mix(ref b4, ref b9, 60);
            Mix(ref b14, ref b1, 44);
            Mix(ref b8, ref b5, 9);
            Mix(ref b10, ref b3, 59);
            Mix(ref b12, ref b7, 34);
            Mix(ref b0, ref b1, 28, k7, k8);
            Mix(ref b2, ref b3, 7, k9, k10);
            Mix(ref b4, ref b5, 47, k11, k12);
            Mix(ref b6, ref b7, 48, k13, k14);
            Mix(ref b8, ref b9, 51, k15, k16);
            Mix(ref b10, ref b11, 9, k0, k1);
            Mix(ref b12, ref b13, 35, k2, k3 + t1);
            Mix(ref b14, ref b15, 41, k4 + t2, k5 + 7);
            Mix(ref b0, ref b9, 17);
            Mix(ref b2, ref b13, 6);
            Mix(ref b6, ref b11, 18);
            Mix(ref b4, ref b15, 25);
            Mix(ref b10, ref b7, 43);
            Mix(ref b12, ref b3, 42);
            Mix(ref b14, ref b5, 40);
            Mix(ref b8, ref b1, 15);
            Mix(ref b0, ref b7, 58);
            Mix(ref b2, ref b5, 7);
            Mix(ref b4, ref b3, 32);
            Mix(ref b6, ref b1, 45);
            Mix(ref b12, ref b15, 19);
            Mix(ref b14, ref b13, 18);
            Mix(ref b8, ref b11, 2);
            Mix(ref b10, ref b9, 56);
            Mix(ref b0, ref b15, 47);
            Mix(ref b2, ref b11, 49);
            Mix(ref b6, ref b13, 27);
            Mix(ref b4, ref b9, 58);
            Mix(ref b14, ref b1, 37);
            Mix(ref b8, ref b5, 48);
            Mix(ref b10, ref b3, 53);
            Mix(ref b12, ref b7, 56);
            Mix(ref b0, ref b1, 55, k8, k9);
            Mix(ref b2, ref b3, 43, k10, k11);
            Mix(ref b4, ref b5, 37, k12, k13);
            Mix(ref b6, ref b7, 40, k14, k15);
            Mix(ref b8, ref b9, 16, k16, k0);
            Mix(ref b10, ref b11, 22, k1, k2);
            Mix(ref b12, ref b13, 38, k3, k4 + t2);
            Mix(ref b14, ref b15, 12, k5 + t0, k6 + 8);
            Mix(ref b0, ref b9, 25);
            Mix(ref b2, ref b13, 25);
            Mix(ref b6, ref b11, 46);
            Mix(ref b4, ref b15, 13);
            Mix(ref b10, ref b7, 14);
            Mix(ref b12, ref b3, 13);
            Mix(ref b14, ref b5, 52);
            Mix(ref b8, ref b1, 57);
            Mix(ref b0, ref b7, 33);
            Mix(ref b2, ref b5, 8);
            Mix(ref b4, ref b3, 18);
            Mix(ref b6, ref b1, 57);
            Mix(ref b12, ref b15, 21);
            Mix(ref b14, ref b13, 12);
            Mix(ref b8, ref b11, 32);
            Mix(ref b10, ref b9, 54);
            Mix(ref b0, ref b15, 34);
            Mix(ref b2, ref b11, 43);
            Mix(ref b6, ref b13, 25);
            Mix(ref b4, ref b9, 60);
            Mix(ref b14, ref b1, 44);
            Mix(ref b8, ref b5, 9);
            Mix(ref b10, ref b3, 59);
            Mix(ref b12, ref b7, 34);
            Mix(ref b0, ref b1, 28, k9, k10);
            Mix(ref b2, ref b3, 7, k11, k12);
            Mix(ref b4, ref b5, 47, k13, k14);
            Mix(ref b6, ref b7, 48, k15, k16);
            Mix(ref b8, ref b9, 51, k0, k1);
            Mix(ref b10, ref b11, 9, k2, k3);
            Mix(ref b12, ref b13, 35, k4, k5 + t0);
            Mix(ref b14, ref b15, 41, k6 + t1, k7 + 9);
            Mix(ref b0, ref b9, 17);
            Mix(ref b2, ref b13, 6);
            Mix(ref b6, ref b11, 18);
            Mix(ref b4, ref b15, 25);
            Mix(ref b10, ref b7, 43);
            Mix(ref b12, ref b3, 42);
            Mix(ref b14, ref b5, 40);
            Mix(ref b8, ref b1, 15);
            Mix(ref b0, ref b7, 58);
            Mix(ref b2, ref b5, 7);
            Mix(ref b4, ref b3, 32);
            Mix(ref b6, ref b1, 45);
            Mix(ref b12, ref b15, 19);
            Mix(ref b14, ref b13, 18);
            Mix(ref b8, ref b11, 2);
            Mix(ref b10, ref b9, 56);
            Mix(ref b0, ref b15, 47);
            Mix(ref b2, ref b11, 49);
            Mix(ref b6, ref b13, 27);
            Mix(ref b4, ref b9, 58);
            Mix(ref b14, ref b1, 37);
            Mix(ref b8, ref b5, 48);
            Mix(ref b10, ref b3, 53);
            Mix(ref b12, ref b7, 56);
            Mix(ref b0, ref b1, 55, k10, k11);
            Mix(ref b2, ref b3, 43, k12, k13);
            Mix(ref b4, ref b5, 37, k14, k15);
            Mix(ref b6, ref b7, 40, k16, k0);
            Mix(ref b8, ref b9, 16, k1, k2);
            Mix(ref b10, ref b11, 22, k3, k4);
            Mix(ref b12, ref b13, 38, k5, k6 + t1);
            Mix(ref b14, ref b15, 12, k7 + t2, k8 + 10);
            Mix(ref b0, ref b9, 25);
            Mix(ref b2, ref b13, 25);
            Mix(ref b6, ref b11, 46);
            Mix(ref b4, ref b15, 13);
            Mix(ref b10, ref b7, 14);
            Mix(ref b12, ref b3, 13);
            Mix(ref b14, ref b5, 52);
            Mix(ref b8, ref b1, 57);
            Mix(ref b0, ref b7, 33);
            Mix(ref b2, ref b5, 8);
            Mix(ref b4, ref b3, 18);
            Mix(ref b6, ref b1, 57);
            Mix(ref b12, ref b15, 21);
            Mix(ref b14, ref b13, 12);
            Mix(ref b8, ref b11, 32);
            Mix(ref b10, ref b9, 54);
            Mix(ref b0, ref b15, 34);
            Mix(ref b2, ref b11, 43);
            Mix(ref b6, ref b13, 25);
            Mix(ref b4, ref b9, 60);
            Mix(ref b14, ref b1, 44);
            Mix(ref b8, ref b5, 9);
            Mix(ref b10, ref b3, 59);
            Mix(ref b12, ref b7, 34);
            Mix(ref b0, ref b1, 28, k11, k12);
            Mix(ref b2, ref b3, 7, k13, k14);
            Mix(ref b4, ref b5, 47, k15, k16);
            Mix(ref b6, ref b7, 48, k0, k1);
            Mix(ref b8, ref b9, 51, k2, k3);
            Mix(ref b10, ref b11, 9, k4, k5);
            Mix(ref b12, ref b13, 35, k6, k7 + t2);
            Mix(ref b14, ref b15, 41, k8 + t0, k9 + 11);
            Mix(ref b0, ref b9, 17);
            Mix(ref b2, ref b13, 6);
            Mix(ref b6, ref b11, 18);
            Mix(ref b4, ref b15, 25);
            Mix(ref b10, ref b7, 43);
            Mix(ref b12, ref b3, 42);
            Mix(ref b14, ref b5, 40);
            Mix(ref b8, ref b1, 15);
            Mix(ref b0, ref b7, 58);
            Mix(ref b2, ref b5, 7);
            Mix(ref b4, ref b3, 32);
            Mix(ref b6, ref b1, 45);
            Mix(ref b12, ref b15, 19);
            Mix(ref b14, ref b13, 18);
            Mix(ref b8, ref b11, 2);
            Mix(ref b10, ref b9, 56);
            Mix(ref b0, ref b15, 47);
            Mix(ref b2, ref b11, 49);
            Mix(ref b6, ref b13, 27);
            Mix(ref b4, ref b9, 58);
            Mix(ref b14, ref b1, 37);
            Mix(ref b8, ref b5, 48);
            Mix(ref b10, ref b3, 53);
            Mix(ref b12, ref b7, 56);
            Mix(ref b0, ref b1, 55, k12, k13);
            Mix(ref b2, ref b3, 43, k14, k15);
            Mix(ref b4, ref b5, 37, k16, k0);
            Mix(ref b6, ref b7, 40, k1, k2);
            Mix(ref b8, ref b9, 16, k3, k4);
            Mix(ref b10, ref b11, 22, k5, k6);
            Mix(ref b12, ref b13, 38, k7, k8 + t0);
            Mix(ref b14, ref b15, 12, k9 + t1, k10 + 12);
            Mix(ref b0, ref b9, 25);
            Mix(ref b2, ref b13, 25);
            Mix(ref b6, ref b11, 46);
            Mix(ref b4, ref b15, 13);
            Mix(ref b10, ref b7, 14);
            Mix(ref b12, ref b3, 13);
            Mix(ref b14, ref b5, 52);
            Mix(ref b8, ref b1, 57);
            Mix(ref b0, ref b7, 33);
            Mix(ref b2, ref b5, 8);
            Mix(ref b4, ref b3, 18);
            Mix(ref b6, ref b1, 57);
            Mix(ref b12, ref b15, 21);
            Mix(ref b14, ref b13, 12);
            Mix(ref b8, ref b11, 32);
            Mix(ref b10, ref b9, 54);
            Mix(ref b0, ref b15, 34);
            Mix(ref b2, ref b11, 43);
            Mix(ref b6, ref b13, 25);
            Mix(ref b4, ref b9, 60);
            Mix(ref b14, ref b1, 44);
            Mix(ref b8, ref b5, 9);
            Mix(ref b10, ref b3, 59);
            Mix(ref b12, ref b7, 34);
            Mix(ref b0, ref b1, 28, k13, k14);
            Mix(ref b2, ref b3, 7, k15, k16);
            Mix(ref b4, ref b5, 47, k0, k1);
            Mix(ref b6, ref b7, 48, k2, k3);
            Mix(ref b8, ref b9, 51, k4, k5);
            Mix(ref b10, ref b11, 9, k6, k7);
            Mix(ref b12, ref b13, 35, k8, k9 + t1);
            Mix(ref b14, ref b15, 41, k10 + t2, k11 + 13);
            Mix(ref b0, ref b9, 17);
            Mix(ref b2, ref b13, 6);
            Mix(ref b6, ref b11, 18);
            Mix(ref b4, ref b15, 25);
            Mix(ref b10, ref b7, 43);
            Mix(ref b12, ref b3, 42);
            Mix(ref b14, ref b5, 40);
            Mix(ref b8, ref b1, 15);
            Mix(ref b0, ref b7, 58);
            Mix(ref b2, ref b5, 7);
            Mix(ref b4, ref b3, 32);
            Mix(ref b6, ref b1, 45);
            Mix(ref b12, ref b15, 19);
            Mix(ref b14, ref b13, 18);
            Mix(ref b8, ref b11, 2);
            Mix(ref b10, ref b9, 56);
            Mix(ref b0, ref b15, 47);
            Mix(ref b2, ref b11, 49);
            Mix(ref b6, ref b13, 27);
            Mix(ref b4, ref b9, 58);
            Mix(ref b14, ref b1, 37);
            Mix(ref b8, ref b5, 48);
            Mix(ref b10, ref b3, 53);
            Mix(ref b12, ref b7, 56);
            Mix(ref b0, ref b1, 55, k14, k15);
            Mix(ref b2, ref b3, 43, k16, k0);
            Mix(ref b4, ref b5, 37, k1, k2);
            Mix(ref b6, ref b7, 40, k3, k4);
            Mix(ref b8, ref b9, 16, k5, k6);
            Mix(ref b10, ref b11, 22, k7, k8);
            Mix(ref b12, ref b13, 38, k9, k10 + t2);
            Mix(ref b14, ref b15, 12, k11 + t0, k12 + 14);
            Mix(ref b0, ref b9, 25);
            Mix(ref b2, ref b13, 25);
            Mix(ref b6, ref b11, 46);
            Mix(ref b4, ref b15, 13);
            Mix(ref b10, ref b7, 14);
            Mix(ref b12, ref b3, 13);
            Mix(ref b14, ref b5, 52);
            Mix(ref b8, ref b1, 57);
            Mix(ref b0, ref b7, 33);
            Mix(ref b2, ref b5, 8);
            Mix(ref b4, ref b3, 18);
            Mix(ref b6, ref b1, 57);
            Mix(ref b12, ref b15, 21);
            Mix(ref b14, ref b13, 12);
            Mix(ref b8, ref b11, 32);
            Mix(ref b10, ref b9, 54);
            Mix(ref b0, ref b15, 34);
            Mix(ref b2, ref b11, 43);
            Mix(ref b6, ref b13, 25);
            Mix(ref b4, ref b9, 60);
            Mix(ref b14, ref b1, 44);
            Mix(ref b8, ref b5, 9);
            Mix(ref b10, ref b3, 59);
            Mix(ref b12, ref b7, 34);
            Mix(ref b0, ref b1, 28, k15, k16);
            Mix(ref b2, ref b3, 7, k0, k1);
            Mix(ref b4, ref b5, 47, k2, k3);
            Mix(ref b6, ref b7, 48, k4, k5);
            Mix(ref b8, ref b9, 51, k6, k7);
            Mix(ref b10, ref b11, 9, k8, k9);
            Mix(ref b12, ref b13, 35, k10, k11 + t0);
            Mix(ref b14, ref b15, 41, k12 + t1, k13 + 15);
            Mix(ref b0, ref b9, 17);
            Mix(ref b2, ref b13, 6);
            Mix(ref b6, ref b11, 18);
            Mix(ref b4, ref b15, 25);
            Mix(ref b10, ref b7, 43);
            Mix(ref b12, ref b3, 42);
            Mix(ref b14, ref b5, 40);
            Mix(ref b8, ref b1, 15);
            Mix(ref b0, ref b7, 58);
            Mix(ref b2, ref b5, 7);
            Mix(ref b4, ref b3, 32);
            Mix(ref b6, ref b1, 45);
            Mix(ref b12, ref b15, 19);
            Mix(ref b14, ref b13, 18);
            Mix(ref b8, ref b11, 2);
            Mix(ref b10, ref b9, 56);
            Mix(ref b0, ref b15, 47);
            Mix(ref b2, ref b11, 49);
            Mix(ref b6, ref b13, 27);
            Mix(ref b4, ref b9, 58);
            Mix(ref b14, ref b1, 37);
            Mix(ref b8, ref b5, 48);
            Mix(ref b10, ref b3, 53);
            Mix(ref b12, ref b7, 56);
            Mix(ref b0, ref b1, 55, k16, k0);
            Mix(ref b2, ref b3, 43, k1, k2);
            Mix(ref b4, ref b5, 37, k3, k4);
            Mix(ref b6, ref b7, 40, k5, k6);
            Mix(ref b8, ref b9, 16, k7, k8);
            Mix(ref b10, ref b11, 22, k9, k10);
            Mix(ref b12, ref b13, 38, k11, k12 + t1);
            Mix(ref b14, ref b15, 12, k13 + t2, k14 + 16);
            Mix(ref b0, ref b9, 25);
            Mix(ref b2, ref b13, 25);
            Mix(ref b6, ref b11, 46);
            Mix(ref b4, ref b15, 13);
            Mix(ref b10, ref b7, 14);
            Mix(ref b12, ref b3, 13);
            Mix(ref b14, ref b5, 52);
            Mix(ref b8, ref b1, 57);
            Mix(ref b0, ref b7, 33);
            Mix(ref b2, ref b5, 8);
            Mix(ref b4, ref b3, 18);
            Mix(ref b6, ref b1, 57);
            Mix(ref b12, ref b15, 21);
            Mix(ref b14, ref b13, 12);
            Mix(ref b8, ref b11, 32);
            Mix(ref b10, ref b9, 54);
            Mix(ref b0, ref b15, 34);
            Mix(ref b2, ref b11, 43);
            Mix(ref b6, ref b13, 25);
            Mix(ref b4, ref b9, 60);
            Mix(ref b14, ref b1, 44);
            Mix(ref b8, ref b5, 9);
            Mix(ref b10, ref b3, 59);
            Mix(ref b12, ref b7, 34);
            Mix(ref b0, ref b1, 28, k0, k1);
            Mix(ref b2, ref b3, 7, k2, k3);
            Mix(ref b4, ref b5, 47, k4, k5);
            Mix(ref b6, ref b7, 48, k6, k7);
            Mix(ref b8, ref b9, 51, k8, k9);
            Mix(ref b10, ref b11, 9, k10, k11);
            Mix(ref b12, ref b13, 35, k12, k13 + t2);
            Mix(ref b14, ref b15, 41, k14 + t0, k15 + 17);
            Mix(ref b0, ref b9, 17);
            Mix(ref b2, ref b13, 6);
            Mix(ref b6, ref b11, 18);
            Mix(ref b4, ref b15, 25);
            Mix(ref b10, ref b7, 43);
            Mix(ref b12, ref b3, 42);
            Mix(ref b14, ref b5, 40);
            Mix(ref b8, ref b1, 15);
            Mix(ref b0, ref b7, 58);
            Mix(ref b2, ref b5, 7);
            Mix(ref b4, ref b3, 32);
            Mix(ref b6, ref b1, 45);
            Mix(ref b12, ref b15, 19);
            Mix(ref b14, ref b13, 18);
            Mix(ref b8, ref b11, 2);
            Mix(ref b10, ref b9, 56);
            Mix(ref b0, ref b15, 47);
            Mix(ref b2, ref b11, 49);
            Mix(ref b6, ref b13, 27);
            Mix(ref b4, ref b9, 58);
            Mix(ref b14, ref b1, 37);
            Mix(ref b8, ref b5, 48);
            Mix(ref b10, ref b3, 53);
            Mix(ref b12, ref b7, 56);
            Mix(ref b0, ref b1, 55, k1, k2);
            Mix(ref b2, ref b3, 43, k3, k4);
            Mix(ref b4, ref b5, 37, k5, k6);
            Mix(ref b6, ref b7, 40, k7, k8);
            Mix(ref b8, ref b9, 16, k9, k10);
            Mix(ref b10, ref b11, 22, k11, k12);
            Mix(ref b12, ref b13, 38, k13, k14 + t0);
            Mix(ref b14, ref b15, 12, k15 + t1, k16 + 18);
            Mix(ref b0, ref b9, 25);
            Mix(ref b2, ref b13, 25);
            Mix(ref b6, ref b11, 46);
            Mix(ref b4, ref b15, 13);
            Mix(ref b10, ref b7, 14);
            Mix(ref b12, ref b3, 13);
            Mix(ref b14, ref b5, 52);
            Mix(ref b8, ref b1, 57);
            Mix(ref b0, ref b7, 33);
            Mix(ref b2, ref b5, 8);
            Mix(ref b4, ref b3, 18);
            Mix(ref b6, ref b1, 57);
            Mix(ref b12, ref b15, 21);
            Mix(ref b14, ref b13, 12);
            Mix(ref b8, ref b11, 32);
            Mix(ref b10, ref b9, 54);
            Mix(ref b0, ref b15, 34);
            Mix(ref b2, ref b11, 43);
            Mix(ref b6, ref b13, 25);
            Mix(ref b4, ref b9, 60);
            Mix(ref b14, ref b1, 44);
            Mix(ref b8, ref b5, 9);
            Mix(ref b10, ref b3, 59);
            Mix(ref b12, ref b7, 34);
            Mix(ref b0, ref b1, 28, k2, k3);
            Mix(ref b2, ref b3, 7, k4, k5);
            Mix(ref b4, ref b5, 47, k6, k7);
            Mix(ref b6, ref b7, 48, k8, k9);
            Mix(ref b8, ref b9, 51, k10, k11);
            Mix(ref b10, ref b11, 9, k12, k13);
            Mix(ref b12, ref b13, 35, k14, k15 + t1);
            Mix(ref b14, ref b15, 41, k16 + t2, k0 + 19);
            Mix(ref b0, ref b9, 17);
            Mix(ref b2, ref b13, 6);
            Mix(ref b6, ref b11, 18);
            Mix(ref b4, ref b15, 25);
            Mix(ref b10, ref b7, 43);
            Mix(ref b12, ref b3, 42);
            Mix(ref b14, ref b5, 40);
            Mix(ref b8, ref b1, 15);
            Mix(ref b0, ref b7, 58);
            Mix(ref b2, ref b5, 7);
            Mix(ref b4, ref b3, 32);
            Mix(ref b6, ref b1, 45);
            Mix(ref b12, ref b15, 19);
            Mix(ref b14, ref b13, 18);
            Mix(ref b8, ref b11, 2);
            Mix(ref b10, ref b9, 56);
            Mix(ref b0, ref b15, 47);
            Mix(ref b2, ref b11, 49);
            Mix(ref b6, ref b13, 27);
            Mix(ref b4, ref b9, 58);
            Mix(ref b14, ref b1, 37);
            Mix(ref b8, ref b5, 48);
            Mix(ref b10, ref b3, 53);
            Mix(ref b12, ref b7, 56);

            // Final key schedule
            output[0] = b0 + k3;
            output[1] = b1 + k4;
            output[2] = b2 + k5;
            output[3] = b3 + k6;
            output[4] = b4 + k7;
            output[5] = b5 + k8;
            output[6] = b6 + k9;
            output[7] = b7 + k10;
            output[8] = b8 + k11;
            output[9] = b9 + k12;
            output[10] = b10 + k13;
            output[11] = b11 + k14;
            output[12] = b12 + k15;
            output[13] = b13 + k16 + t2;
            output[14] = b14 + k0 + t0;
            output[15] = b15 + k1 + 20;
        }

        public override void Decrypt(ulong[] input, ulong[] output)
        {
            // Cache the block, key, and tweak
            ulong b0 = input[0], b1 = input[1],
                  b2 = input[2], b3 = input[3],
                  b4 = input[4], b5 = input[5],
                  b6 = input[6], b7 = input[7],
                  b8 = input[8], b9 = input[9],
                  b10 = input[10], b11 = input[11],
                  b12 = input[12], b13 = input[13],
                  b14 = input[14], b15 = input[15];
            ulong k0 = m_ExpandedKey[0], k1 = m_ExpandedKey[1],
                  k2 = m_ExpandedKey[2], k3 = m_ExpandedKey[3],
                  k4 = m_ExpandedKey[4], k5 = m_ExpandedKey[5],
                  k6 = m_ExpandedKey[6], k7 = m_ExpandedKey[7],
                  k8 = m_ExpandedKey[8], k9 = m_ExpandedKey[9],
                  k10 = m_ExpandedKey[10], k11 = m_ExpandedKey[11],
                  k12 = m_ExpandedKey[12], k13 = m_ExpandedKey[13],
                  k14 = m_ExpandedKey[14], k15 = m_ExpandedKey[15],
                  k16 = m_ExpandedKey[16];
            ulong t0 = m_ExpandedTweak[0], t1 = m_ExpandedTweak[1],
                  t2 = m_ExpandedTweak[2];

            b0 -= k3;
            b1 -= k4;
            b2 -= k5;
            b3 -= k6;
            b4 -= k7;
            b5 -= k8;
            b6 -= k9;
            b7 -= k10;
            b8 -= k11;
            b9 -= k12;
            b10 -= k13;
            b11 -= k14;
            b12 -= k15;
            b13 -= k16 + t2;
            b14 -= k0 + t0;
            b15 -= k1 + 20;
            UnMix(ref b0, ref b15, 47);
            UnMix(ref b2, ref b11, 49);
            UnMix(ref b6, ref b13, 27);
            UnMix(ref b4, ref b9, 58);
            UnMix(ref b14, ref b1, 37);
            UnMix(ref b8, ref b5, 48);
            UnMix(ref b10, ref b3, 53);
            UnMix(ref b12, ref b7, 56);
            UnMix(ref b0, ref b7, 58);
            UnMix(ref b2, ref b5, 7);
            UnMix(ref b4, ref b3, 32);
            UnMix(ref b6, ref b1, 45);
            UnMix(ref b12, ref b15, 19);
            UnMix(ref b14, ref b13, 18);
            UnMix(ref b8, ref b11, 2);
            UnMix(ref b10, ref b9, 56);
            UnMix(ref b0, ref b9, 17);
            UnMix(ref b2, ref b13, 6);
            UnMix(ref b6, ref b11, 18);
            UnMix(ref b4, ref b15, 25);
            UnMix(ref b10, ref b7, 43);
            UnMix(ref b12, ref b3, 42);
            UnMix(ref b14, ref b5, 40);
            UnMix(ref b8, ref b1, 15);
            UnMix(ref b0, ref b1, 28, k2, k3);
            UnMix(ref b2, ref b3, 7, k4, k5);
            UnMix(ref b4, ref b5, 47, k6, k7);
            UnMix(ref b6, ref b7, 48, k8, k9);
            UnMix(ref b8, ref b9, 51, k10, k11);
            UnMix(ref b10, ref b11, 9, k12, k13);
            UnMix(ref b12, ref b13, 35, k14, k15 + t1);
            UnMix(ref b14, ref b15, 41, k16 + t2, k0 + 19);
            UnMix(ref b0, ref b15, 34);
            UnMix(ref b2, ref b11, 43);
            UnMix(ref b6, ref b13, 25);
            UnMix(ref b4, ref b9, 60);
            UnMix(ref b14, ref b1, 44);
            UnMix(ref b8, ref b5, 9);
            UnMix(ref b10, ref b3, 59);
            UnMix(ref b12, ref b7, 34);
            UnMix(ref b0, ref b7, 33);
            UnMix(ref b2, ref b5, 8);
            UnMix(ref b4, ref b3, 18);
            UnMix(ref b6, ref b1, 57);
            UnMix(ref b12, ref b15, 21);
            UnMix(ref b14, ref b13, 12);
            UnMix(ref b8, ref b11, 32);
            UnMix(ref b10, ref b9, 54);
            UnMix(ref b0, ref b9, 25);
            UnMix(ref b2, ref b13, 25);
            UnMix(ref b6, ref b11, 46);
            UnMix(ref b4, ref b15, 13);
            UnMix(ref b10, ref b7, 14);
            UnMix(ref b12, ref b3, 13);
            UnMix(ref b14, ref b5, 52);
            UnMix(ref b8, ref b1, 57);
            UnMix(ref b0, ref b1, 55, k1, k2);
            UnMix(ref b2, ref b3, 43, k3, k4);
            UnMix(ref b4, ref b5, 37, k5, k6);
            UnMix(ref b6, ref b7, 40, k7, k8);
            UnMix(ref b8, ref b9, 16, k9, k10);
            UnMix(ref b10, ref b11, 22, k11, k12);
            UnMix(ref b12, ref b13, 38, k13, k14 + t0);
            UnMix(ref b14, ref b15, 12, k15 + t1, k16 + 18);
            UnMix(ref b0, ref b15, 47);
            UnMix(ref b2, ref b11, 49);
            UnMix(ref b6, ref b13, 27);
            UnMix(ref b4, ref b9, 58);
            UnMix(ref b14, ref b1, 37);
            UnMix(ref b8, ref b5, 48);
            UnMix(ref b10, ref b3, 53);
            UnMix(ref b12, ref b7, 56);
            UnMix(ref b0, ref b7, 58);
            UnMix(ref b2, ref b5, 7);
            UnMix(ref b4, ref b3, 32);
            UnMix(ref b6, ref b1, 45);
            UnMix(ref b12, ref b15, 19);
            UnMix(ref b14, ref b13, 18);
            UnMix(ref b8, ref b11, 2);
            UnMix(ref b10, ref b9, 56);
            UnMix(ref b0, ref b9, 17);
            UnMix(ref b2, ref b13, 6);
            UnMix(ref b6, ref b11, 18);
            UnMix(ref b4, ref b15, 25);
            UnMix(ref b10, ref b7, 43);
            UnMix(ref b12, ref b3, 42);
            UnMix(ref b14, ref b5, 40);
            UnMix(ref b8, ref b1, 15);
            UnMix(ref b0, ref b1, 28, k0, k1);
            UnMix(ref b2, ref b3, 7, k2, k3);
            UnMix(ref b4, ref b5, 47, k4, k5);
            UnMix(ref b6, ref b7, 48, k6, k7);
            UnMix(ref b8, ref b9, 51, k8, k9);
            UnMix(ref b10, ref b11, 9, k10, k11);
            UnMix(ref b12, ref b13, 35, k12, k13 + t2);
            UnMix(ref b14, ref b15, 41, k14 + t0, k15 + 17);
            UnMix(ref b0, ref b15, 34);
            UnMix(ref b2, ref b11, 43);
            UnMix(ref b6, ref b13, 25);
            UnMix(ref b4, ref b9, 60);
            UnMix(ref b14, ref b1, 44);
            UnMix(ref b8, ref b5, 9);
            UnMix(ref b10, ref b3, 59);
            UnMix(ref b12, ref b7, 34);
            UnMix(ref b0, ref b7, 33);
            UnMix(ref b2, ref b5, 8);
            UnMix(ref b4, ref b3, 18);
            UnMix(ref b6, ref b1, 57);
            UnMix(ref b12, ref b15, 21);
            UnMix(ref b14, ref b13, 12);
            UnMix(ref b8, ref b11, 32);
            UnMix(ref b10, ref b9, 54);
            UnMix(ref b0, ref b9, 25);
            UnMix(ref b2, ref b13, 25);
            UnMix(ref b6, ref b11, 46);
            UnMix(ref b4, ref b15, 13);
            UnMix(ref b10, ref b7, 14);
            UnMix(ref b12, ref b3, 13);
            UnMix(ref b14, ref b5, 52);
            UnMix(ref b8, ref b1, 57);
            UnMix(ref b0, ref b1, 55, k16, k0);
            UnMix(ref b2, ref b3, 43, k1, k2);
            UnMix(ref b4, ref b5, 37, k3, k4);
            UnMix(ref b6, ref b7, 40, k5, k6);
            UnMix(ref b8, ref b9, 16, k7, k8);
            UnMix(ref b10, ref b11, 22, k9, k10);
            UnMix(ref b12, ref b13, 38, k11, k12 + t1);
            UnMix(ref b14, ref b15, 12, k13 + t2, k14 + 16);
            UnMix(ref b0, ref b15, 47);
            UnMix(ref b2, ref b11, 49);
            UnMix(ref b6, ref b13, 27);
            UnMix(ref b4, ref b9, 58);
            UnMix(ref b14, ref b1, 37);
            UnMix(ref b8, ref b5, 48);
            UnMix(ref b10, ref b3, 53);
            UnMix(ref b12, ref b7, 56);
            UnMix(ref b0, ref b7, 58);
            UnMix(ref b2, ref b5, 7);
            UnMix(ref b4, ref b3, 32);
            UnMix(ref b6, ref b1, 45);
            UnMix(ref b12, ref b15, 19);
            UnMix(ref b14, ref b13, 18);
            UnMix(ref b8, ref b11, 2);
            UnMix(ref b10, ref b9, 56);
            UnMix(ref b0, ref b9, 17);
            UnMix(ref b2, ref b13, 6);
            UnMix(ref b6, ref b11, 18);
            UnMix(ref b4, ref b15, 25);
            UnMix(ref b10, ref b7, 43);
            UnMix(ref b12, ref b3, 42);
            UnMix(ref b14, ref b5, 40);
            UnMix(ref b8, ref b1, 15);
            UnMix(ref b0, ref b1, 28, k15, k16);
            UnMix(ref b2, ref b3, 7, k0, k1);
            UnMix(ref b4, ref b5, 47, k2, k3);
            UnMix(ref b6, ref b7, 48, k4, k5);
            UnMix(ref b8, ref b9, 51, k6, k7);
            UnMix(ref b10, ref b11, 9, k8, k9);
            UnMix(ref b12, ref b13, 35, k10, k11 + t0);
            UnMix(ref b14, ref b15, 41, k12 + t1, k13 + 15);
            UnMix(ref b0, ref b15, 34);
            UnMix(ref b2, ref b11, 43);
            UnMix(ref b6, ref b13, 25);
            UnMix(ref b4, ref b9, 60);
            UnMix(ref b14, ref b1, 44);
            UnMix(ref b8, ref b5, 9);
            UnMix(ref b10, ref b3, 59);
            UnMix(ref b12, ref b7, 34);
            UnMix(ref b0, ref b7, 33);
            UnMix(ref b2, ref b5, 8);
            UnMix(ref b4, ref b3, 18);
            UnMix(ref b6, ref b1, 57);
            UnMix(ref b12, ref b15, 21);
            UnMix(ref b14, ref b13, 12);
            UnMix(ref b8, ref b11, 32);
            UnMix(ref b10, ref b9, 54);
            UnMix(ref b0, ref b9, 25);
            UnMix(ref b2, ref b13, 25);
            UnMix(ref b6, ref b11, 46);
            UnMix(ref b4, ref b15, 13);
            UnMix(ref b10, ref b7, 14);
            UnMix(ref b12, ref b3, 13);
            UnMix(ref b14, ref b5, 52);
            UnMix(ref b8, ref b1, 57);
            UnMix(ref b0, ref b1, 55, k14, k15);
            UnMix(ref b2, ref b3, 43, k16, k0);
            UnMix(ref b4, ref b5, 37, k1, k2);
            UnMix(ref b6, ref b7, 40, k3, k4);
            UnMix(ref b8, ref b9, 16, k5, k6);
            UnMix(ref b10, ref b11, 22, k7, k8);
            UnMix(ref b12, ref b13, 38, k9, k10 + t2);
            UnMix(ref b14, ref b15, 12, k11 + t0, k12 + 14);
            UnMix(ref b0, ref b15, 47);
            UnMix(ref b2, ref b11, 49);
            UnMix(ref b6, ref b13, 27);
            UnMix(ref b4, ref b9, 58);
            UnMix(ref b14, ref b1, 37);
            UnMix(ref b8, ref b5, 48);
            UnMix(ref b10, ref b3, 53);
            UnMix(ref b12, ref b7, 56);
            UnMix(ref b0, ref b7, 58);
            UnMix(ref b2, ref b5, 7);
            UnMix(ref b4, ref b3, 32);
            UnMix(ref b6, ref b1, 45);
            UnMix(ref b12, ref b15, 19);
            UnMix(ref b14, ref b13, 18);
            UnMix(ref b8, ref b11, 2);
            UnMix(ref b10, ref b9, 56);
            UnMix(ref b0, ref b9, 17);
            UnMix(ref b2, ref b13, 6);
            UnMix(ref b6, ref b11, 18);
            UnMix(ref b4, ref b15, 25);
            UnMix(ref b10, ref b7, 43);
            UnMix(ref b12, ref b3, 42);
            UnMix(ref b14, ref b5, 40);
            UnMix(ref b8, ref b1, 15);
            UnMix(ref b0, ref b1, 28, k13, k14);
            UnMix(ref b2, ref b3, 7, k15, k16);
            UnMix(ref b4, ref b5, 47, k0, k1);
            UnMix(ref b6, ref b7, 48, k2, k3);
            UnMix(ref b8, ref b9, 51, k4, k5);
            UnMix(ref b10, ref b11, 9, k6, k7);
            UnMix(ref b12, ref b13, 35, k8, k9 + t1);
            UnMix(ref b14, ref b15, 41, k10 + t2, k11 + 13);
            UnMix(ref b0, ref b15, 34);
            UnMix(ref b2, ref b11, 43);
            UnMix(ref b6, ref b13, 25);
            UnMix(ref b4, ref b9, 60);
            UnMix(ref b14, ref b1, 44);
            UnMix(ref b8, ref b5, 9);
            UnMix(ref b10, ref b3, 59);
            UnMix(ref b12, ref b7, 34);
            UnMix(ref b0, ref b7, 33);
            UnMix(ref b2, ref b5, 8);
            UnMix(ref b4, ref b3, 18);
            UnMix(ref b6, ref b1, 57);
            UnMix(ref b12, ref b15, 21);
            UnMix(ref b14, ref b13, 12);
            UnMix(ref b8, ref b11, 32);
            UnMix(ref b10, ref b9, 54);
            UnMix(ref b0, ref b9, 25);
            UnMix(ref b2, ref b13, 25);
            UnMix(ref b6, ref b11, 46);
            UnMix(ref b4, ref b15, 13);
            UnMix(ref b10, ref b7, 14);
            UnMix(ref b12, ref b3, 13);
            UnMix(ref b14, ref b5, 52);
            UnMix(ref b8, ref b1, 57);
            UnMix(ref b0, ref b1, 55, k12, k13);
            UnMix(ref b2, ref b3, 43, k14, k15);
            UnMix(ref b4, ref b5, 37, k16, k0);
            UnMix(ref b6, ref b7, 40, k1, k2);
            UnMix(ref b8, ref b9, 16, k3, k4);
            UnMix(ref b10, ref b11, 22, k5, k6);
            UnMix(ref b12, ref b13, 38, k7, k8 + t0);
            UnMix(ref b14, ref b15, 12, k9 + t1, k10 + 12);
            UnMix(ref b0, ref b15, 47);
            UnMix(ref b2, ref b11, 49);
            UnMix(ref b6, ref b13, 27);
            UnMix(ref b4, ref b9, 58);
            UnMix(ref b14, ref b1, 37);
            UnMix(ref b8, ref b5, 48);
            UnMix(ref b10, ref b3, 53);
            UnMix(ref b12, ref b7, 56);
            UnMix(ref b0, ref b7, 58);
            UnMix(ref b2, ref b5, 7);
            UnMix(ref b4, ref b3, 32);
            UnMix(ref b6, ref b1, 45);
            UnMix(ref b12, ref b15, 19);
            UnMix(ref b14, ref b13, 18);
            UnMix(ref b8, ref b11, 2);
            UnMix(ref b10, ref b9, 56);
            UnMix(ref b0, ref b9, 17);
            UnMix(ref b2, ref b13, 6);
            UnMix(ref b6, ref b11, 18);
            UnMix(ref b4, ref b15, 25);
            UnMix(ref b10, ref b7, 43);
            UnMix(ref b12, ref b3, 42);
            UnMix(ref b14, ref b5, 40);
            UnMix(ref b8, ref b1, 15);
            UnMix(ref b0, ref b1, 28, k11, k12);
            UnMix(ref b2, ref b3, 7, k13, k14);
            UnMix(ref b4, ref b5, 47, k15, k16);
            UnMix(ref b6, ref b7, 48, k0, k1);
            UnMix(ref b8, ref b9, 51, k2, k3);
            UnMix(ref b10, ref b11, 9, k4, k5);
            UnMix(ref b12, ref b13, 35, k6, k7 + t2);
            UnMix(ref b14, ref b15, 41, k8 + t0, k9 + 11);
            UnMix(ref b0, ref b15, 34);
            UnMix(ref b2, ref b11, 43);
            UnMix(ref b6, ref b13, 25);
            UnMix(ref b4, ref b9, 60);
            UnMix(ref b14, ref b1, 44);
            UnMix(ref b8, ref b5, 9);
            UnMix(ref b10, ref b3, 59);
            UnMix(ref b12, ref b7, 34);
            UnMix(ref b0, ref b7, 33);
            UnMix(ref b2, ref b5, 8);
            UnMix(ref b4, ref b3, 18);
            UnMix(ref b6, ref b1, 57);
            UnMix(ref b12, ref b15, 21);
            UnMix(ref b14, ref b13, 12);
            UnMix(ref b8, ref b11, 32);
            UnMix(ref b10, ref b9, 54);
            UnMix(ref b0, ref b9, 25);
            UnMix(ref b2, ref b13, 25);
            UnMix(ref b6, ref b11, 46);
            UnMix(ref b4, ref b15, 13);
            UnMix(ref b10, ref b7, 14);
            UnMix(ref b12, ref b3, 13);
            UnMix(ref b14, ref b5, 52);
            UnMix(ref b8, ref b1, 57);
            UnMix(ref b0, ref b1, 55, k10, k11);
            UnMix(ref b2, ref b3, 43, k12, k13);
            UnMix(ref b4, ref b5, 37, k14, k15);
            UnMix(ref b6, ref b7, 40, k16, k0);
            UnMix(ref b8, ref b9, 16, k1, k2);
            UnMix(ref b10, ref b11, 22, k3, k4);
            UnMix(ref b12, ref b13, 38, k5, k6 + t1);
            UnMix(ref b14, ref b15, 12, k7 + t2, k8 + 10);
            UnMix(ref b0, ref b15, 47);
            UnMix(ref b2, ref b11, 49);
            UnMix(ref b6, ref b13, 27);
            UnMix(ref b4, ref b9, 58);
            UnMix(ref b14, ref b1, 37);
            UnMix(ref b8, ref b5, 48);
            UnMix(ref b10, ref b3, 53);
            UnMix(ref b12, ref b7, 56);
            UnMix(ref b0, ref b7, 58);
            UnMix(ref b2, ref b5, 7);
            UnMix(ref b4, ref b3, 32);
            UnMix(ref b6, ref b1, 45);
            UnMix(ref b12, ref b15, 19);
            UnMix(ref b14, ref b13, 18);
            UnMix(ref b8, ref b11, 2);
            UnMix(ref b10, ref b9, 56);
            UnMix(ref b0, ref b9, 17);
            UnMix(ref b2, ref b13, 6);
            UnMix(ref b6, ref b11, 18);
            UnMix(ref b4, ref b15, 25);
            UnMix(ref b10, ref b7, 43);
            UnMix(ref b12, ref b3, 42);
            UnMix(ref b14, ref b5, 40);
            UnMix(ref b8, ref b1, 15);
            UnMix(ref b0, ref b1, 28, k9, k10);
            UnMix(ref b2, ref b3, 7, k11, k12);
            UnMix(ref b4, ref b5, 47, k13, k14);
            UnMix(ref b6, ref b7, 48, k15, k16);
            UnMix(ref b8, ref b9, 51, k0, k1);
            UnMix(ref b10, ref b11, 9, k2, k3);
            UnMix(ref b12, ref b13, 35, k4, k5 + t0);
            UnMix(ref b14, ref b15, 41, k6 + t1, k7 + 9);
            UnMix(ref b0, ref b15, 34);
            UnMix(ref b2, ref b11, 43);
            UnMix(ref b6, ref b13, 25);
            UnMix(ref b4, ref b9, 60);
            UnMix(ref b14, ref b1, 44);
            UnMix(ref b8, ref b5, 9);
            UnMix(ref b10, ref b3, 59);
            UnMix(ref b12, ref b7, 34);
            UnMix(ref b0, ref b7, 33);
            UnMix(ref b2, ref b5, 8);
            UnMix(ref b4, ref b3, 18);
            UnMix(ref b6, ref b1, 57);
            UnMix(ref b12, ref b15, 21);
            UnMix(ref b14, ref b13, 12);
            UnMix(ref b8, ref b11, 32);
            UnMix(ref b10, ref b9, 54);
            UnMix(ref b0, ref b9, 25);
            UnMix(ref b2, ref b13, 25);
            UnMix(ref b6, ref b11, 46);
            UnMix(ref b4, ref b15, 13);
            UnMix(ref b10, ref b7, 14);
            UnMix(ref b12, ref b3, 13);
            UnMix(ref b14, ref b5, 52);
            UnMix(ref b8, ref b1, 57);
            UnMix(ref b0, ref b1, 55, k8, k9);
            UnMix(ref b2, ref b3, 43, k10, k11);
            UnMix(ref b4, ref b5, 37, k12, k13);
            UnMix(ref b6, ref b7, 40, k14, k15);
            UnMix(ref b8, ref b9, 16, k16, k0);
            UnMix(ref b10, ref b11, 22, k1, k2);
            UnMix(ref b12, ref b13, 38, k3, k4 + t2);
            UnMix(ref b14, ref b15, 12, k5 + t0, k6 + 8);
            UnMix(ref b0, ref b15, 47);
            UnMix(ref b2, ref b11, 49);
            UnMix(ref b6, ref b13, 27);
            UnMix(ref b4, ref b9, 58);
            UnMix(ref b14, ref b1, 37);
            UnMix(ref b8, ref b5, 48);
            UnMix(ref b10, ref b3, 53);
            UnMix(ref b12, ref b7, 56);
            UnMix(ref b0, ref b7, 58);
            UnMix(ref b2, ref b5, 7);
            UnMix(ref b4, ref b3, 32);
            UnMix(ref b6, ref b1, 45);
            UnMix(ref b12, ref b15, 19);
            UnMix(ref b14, ref b13, 18);
            UnMix(ref b8, ref b11, 2);
            UnMix(ref b10, ref b9, 56);
            UnMix(ref b0, ref b9, 17);
            UnMix(ref b2, ref b13, 6);
            UnMix(ref b6, ref b11, 18);
            UnMix(ref b4, ref b15, 25);
            UnMix(ref b10, ref b7, 43);
            UnMix(ref b12, ref b3, 42);
            UnMix(ref b14, ref b5, 40);
            UnMix(ref b8, ref b1, 15);
            UnMix(ref b0, ref b1, 28, k7, k8);
            UnMix(ref b2, ref b3, 7, k9, k10);
            UnMix(ref b4, ref b5, 47, k11, k12);
            UnMix(ref b6, ref b7, 48, k13, k14);
            UnMix(ref b8, ref b9, 51, k15, k16);
            UnMix(ref b10, ref b11, 9, k0, k1);
            UnMix(ref b12, ref b13, 35, k2, k3 + t1);
            UnMix(ref b14, ref b15, 41, k4 + t2, k5 + 7);
            UnMix(ref b0, ref b15, 34);
            UnMix(ref b2, ref b11, 43);
            UnMix(ref b6, ref b13, 25);
            UnMix(ref b4, ref b9, 60);
            UnMix(ref b14, ref b1, 44);
            UnMix(ref b8, ref b5, 9);
            UnMix(ref b10, ref b3, 59);
            UnMix(ref b12, ref b7, 34);
            UnMix(ref b0, ref b7, 33);
            UnMix(ref b2, ref b5, 8);
            UnMix(ref b4, ref b3, 18);
            UnMix(ref b6, ref b1, 57);
            UnMix(ref b12, ref b15, 21);
            UnMix(ref b14, ref b13, 12);
            UnMix(ref b8, ref b11, 32);
            UnMix(ref b10, ref b9, 54);
            UnMix(ref b0, ref b9, 25);
            UnMix(ref b2, ref b13, 25);
            UnMix(ref b6, ref b11, 46);
            UnMix(ref b4, ref b15, 13);
            UnMix(ref b10, ref b7, 14);
            UnMix(ref b12, ref b3, 13);
            UnMix(ref b14, ref b5, 52);
            UnMix(ref b8, ref b1, 57);
            UnMix(ref b0, ref b1, 55, k6, k7);
            UnMix(ref b2, ref b3, 43, k8, k9);
            UnMix(ref b4, ref b5, 37, k10, k11);
            UnMix(ref b6, ref b7, 40, k12, k13);
            UnMix(ref b8, ref b9, 16, k14, k15);
            UnMix(ref b10, ref b11, 22, k16, k0);
            UnMix(ref b12, ref b13, 38, k1, k2 + t0);
            UnMix(ref b14, ref b15, 12, k3 + t1, k4 + 6);
            UnMix(ref b0, ref b15, 47);
            UnMix(ref b2, ref b11, 49);
            UnMix(ref b6, ref b13, 27);
            UnMix(ref b4, ref b9, 58);
            UnMix(ref b14, ref b1, 37);
            UnMix(ref b8, ref b5, 48);
            UnMix(ref b10, ref b3, 53);
            UnMix(ref b12, ref b7, 56);
            UnMix(ref b0, ref b7, 58);
            UnMix(ref b2, ref b5, 7);
            UnMix(ref b4, ref b3, 32);
            UnMix(ref b6, ref b1, 45);
            UnMix(ref b12, ref b15, 19);
            UnMix(ref b14, ref b13, 18);
            UnMix(ref b8, ref b11, 2);
            UnMix(ref b10, ref b9, 56);
            UnMix(ref b0, ref b9, 17);
            UnMix(ref b2, ref b13, 6);
            UnMix(ref b6, ref b11, 18);
            UnMix(ref b4, ref b15, 25);
            UnMix(ref b10, ref b7, 43);
            UnMix(ref b12, ref b3, 42);
            UnMix(ref b14, ref b5, 40);
            UnMix(ref b8, ref b1, 15);
            UnMix(ref b0, ref b1, 28, k5, k6);
            UnMix(ref b2, ref b3, 7, k7, k8);
            UnMix(ref b4, ref b5, 47, k9, k10);
            UnMix(ref b6, ref b7, 48, k11, k12);
            UnMix(ref b8, ref b9, 51, k13, k14);
            UnMix(ref b10, ref b11, 9, k15, k16);
            UnMix(ref b12, ref b13, 35, k0, k1 + t2);
            UnMix(ref b14, ref b15, 41, k2 + t0, k3 + 5);
            UnMix(ref b0, ref b15, 34);
            UnMix(ref b2, ref b11, 43);
            UnMix(ref b6, ref b13, 25);
            UnMix(ref b4, ref b9, 60);
            UnMix(ref b14, ref b1, 44);
            UnMix(ref b8, ref b5, 9);
            UnMix(ref b10, ref b3, 59);
            UnMix(ref b12, ref b7, 34);
            UnMix(ref b0, ref b7, 33);
            UnMix(ref b2, ref b5, 8);
            UnMix(ref b4, ref b3, 18);
            UnMix(ref b6, ref b1, 57);
            UnMix(ref b12, ref b15, 21);
            UnMix(ref b14, ref b13, 12);
            UnMix(ref b8, ref b11, 32);
            UnMix(ref b10, ref b9, 54);
            UnMix(ref b0, ref b9, 25);
            UnMix(ref b2, ref b13, 25);
            UnMix(ref b6, ref b11, 46);
            UnMix(ref b4, ref b15, 13);
            UnMix(ref b10, ref b7, 14);
            UnMix(ref b12, ref b3, 13);
            UnMix(ref b14, ref b5, 52);
            UnMix(ref b8, ref b1, 57);
            UnMix(ref b0, ref b1, 55, k4, k5);
            UnMix(ref b2, ref b3, 43, k6, k7);
            UnMix(ref b4, ref b5, 37, k8, k9);
            UnMix(ref b6, ref b7, 40, k10, k11);
            UnMix(ref b8, ref b9, 16, k12, k13);
            UnMix(ref b10, ref b11, 22, k14, k15);
            UnMix(ref b12, ref b13, 38, k16, k0 + t1);
            UnMix(ref b14, ref b15, 12, k1 + t2, k2 + 4);
            UnMix(ref b0, ref b15, 47);
            UnMix(ref b2, ref b11, 49);
            UnMix(ref b6, ref b13, 27);
            UnMix(ref b4, ref b9, 58);
            UnMix(ref b14, ref b1, 37);
            UnMix(ref b8, ref b5, 48);
            UnMix(ref b10, ref b3, 53);
            UnMix(ref b12, ref b7, 56);
            UnMix(ref b0, ref b7, 58);
            UnMix(ref b2, ref b5, 7);
            UnMix(ref b4, ref b3, 32);
            UnMix(ref b6, ref b1, 45);
            UnMix(ref b12, ref b15, 19);
            UnMix(ref b14, ref b13, 18);
            UnMix(ref b8, ref b11, 2);
            UnMix(ref b10, ref b9, 56);
            UnMix(ref b0, ref b9, 17);
            UnMix(ref b2, ref b13, 6);
            UnMix(ref b6, ref b11, 18);
            UnMix(ref b4, ref b15, 25);
            UnMix(ref b10, ref b7, 43);
            UnMix(ref b12, ref b3, 42);
            UnMix(ref b14, ref b5, 40);
            UnMix(ref b8, ref b1, 15);
            UnMix(ref b0, ref b1, 28, k3, k4);
            UnMix(ref b2, ref b3, 7, k5, k6);
            UnMix(ref b4, ref b5, 47, k7, k8);
            UnMix(ref b6, ref b7, 48, k9, k10);
            UnMix(ref b8, ref b9, 51, k11, k12);
            UnMix(ref b10, ref b11, 9, k13, k14);
            UnMix(ref b12, ref b13, 35, k15, k16 + t0);
            UnMix(ref b14, ref b15, 41, k0 + t1, k1 + 3);
            UnMix(ref b0, ref b15, 34);
            UnMix(ref b2, ref b11, 43);
            UnMix(ref b6, ref b13, 25);
            UnMix(ref b4, ref b9, 60);
            UnMix(ref b14, ref b1, 44);
            UnMix(ref b8, ref b5, 9);
            UnMix(ref b10, ref b3, 59);
            UnMix(ref b12, ref b7, 34);
            UnMix(ref b0, ref b7, 33);
            UnMix(ref b2, ref b5, 8);
            UnMix(ref b4, ref b3, 18);
            UnMix(ref b6, ref b1, 57);
            UnMix(ref b12, ref b15, 21);
            UnMix(ref b14, ref b13, 12);
            UnMix(ref b8, ref b11, 32);
            UnMix(ref b10, ref b9, 54);
            UnMix(ref b0, ref b9, 25);
            UnMix(ref b2, ref b13, 25);
            UnMix(ref b6, ref b11, 46);
            UnMix(ref b4, ref b15, 13);
            UnMix(ref b10, ref b7, 14);
            UnMix(ref b12, ref b3, 13);
            UnMix(ref b14, ref b5, 52);
            UnMix(ref b8, ref b1, 57);
            UnMix(ref b0, ref b1, 55, k2, k3);
            UnMix(ref b2, ref b3, 43, k4, k5);
            UnMix(ref b4, ref b5, 37, k6, k7);
            UnMix(ref b6, ref b7, 40, k8, k9);
            UnMix(ref b8, ref b9, 16, k10, k11);
            UnMix(ref b10, ref b11, 22, k12, k13);
            UnMix(ref b12, ref b13, 38, k14, k15 + t2);
            UnMix(ref b14, ref b15, 12, k16 + t0, k0 + 2);
            UnMix(ref b0, ref b15, 47);
            UnMix(ref b2, ref b11, 49);
            UnMix(ref b6, ref b13, 27);
            UnMix(ref b4, ref b9, 58);
            UnMix(ref b14, ref b1, 37);
            UnMix(ref b8, ref b5, 48);
            UnMix(ref b10, ref b3, 53);
            UnMix(ref b12, ref b7, 56);
            UnMix(ref b0, ref b7, 58);
            UnMix(ref b2, ref b5, 7);
            UnMix(ref b4, ref b3, 32);
            UnMix(ref b6, ref b1, 45);
            UnMix(ref b12, ref b15, 19);
            UnMix(ref b14, ref b13, 18);
            UnMix(ref b8, ref b11, 2);
            UnMix(ref b10, ref b9, 56);
            UnMix(ref b0, ref b9, 17);
            UnMix(ref b2, ref b13, 6);
            UnMix(ref b6, ref b11, 18);
            UnMix(ref b4, ref b15, 25);
            UnMix(ref b10, ref b7, 43);
            UnMix(ref b12, ref b3, 42);
            UnMix(ref b14, ref b5, 40);
            UnMix(ref b8, ref b1, 15);
            UnMix(ref b0, ref b1, 28, k1, k2);
            UnMix(ref b2, ref b3, 7, k3, k4);
            UnMix(ref b4, ref b5, 47, k5, k6);
            UnMix(ref b6, ref b7, 48, k7, k8);
            UnMix(ref b8, ref b9, 51, k9, k10);
            UnMix(ref b10, ref b11, 9, k11, k12);
            UnMix(ref b12, ref b13, 35, k13, k14 + t1);
            UnMix(ref b14, ref b15, 41, k15 + t2, k16 + 1);
            UnMix(ref b0, ref b15, 34);
            UnMix(ref b2, ref b11, 43);
            UnMix(ref b6, ref b13, 25);
            UnMix(ref b4, ref b9, 60);
            UnMix(ref b14, ref b1, 44);
            UnMix(ref b8, ref b5, 9);
            UnMix(ref b10, ref b3, 59);
            UnMix(ref b12, ref b7, 34);
            UnMix(ref b0, ref b7, 33);
            UnMix(ref b2, ref b5, 8);
            UnMix(ref b4, ref b3, 18);
            UnMix(ref b6, ref b1, 57);
            UnMix(ref b12, ref b15, 21);
            UnMix(ref b14, ref b13, 12);
            UnMix(ref b8, ref b11, 32);
            UnMix(ref b10, ref b9, 54);
            UnMix(ref b0, ref b9, 25);
            UnMix(ref b2, ref b13, 25);
            UnMix(ref b6, ref b11, 46);
            UnMix(ref b4, ref b15, 13);
            UnMix(ref b10, ref b7, 14);
            UnMix(ref b12, ref b3, 13);
            UnMix(ref b14, ref b5, 52);
            UnMix(ref b8, ref b1, 57);
            UnMix(ref b0, ref b1, 55, k0, k1);
            UnMix(ref b2, ref b3, 43, k2, k3);
            UnMix(ref b4, ref b5, 37, k4, k5);
            UnMix(ref b6, ref b7, 40, k6, k7);
            UnMix(ref b8, ref b9, 16, k8, k9);
            UnMix(ref b10, ref b11, 22, k10, k11);
            UnMix(ref b12, ref b13, 38, k12, k13 + t0);
            UnMix(ref b14, ref b15, 12, k14 + t1, k15);

            output[15] = b15;
            output[14] = b14;
            output[13] = b13;
            output[12] = b12;
            output[11] = b11;
            output[10] = b10;
            output[9] = b9;
            output[8] = b8;
            output[7] = b7;
            output[6] = b6;
            output[5] = b5;
            output[4] = b4;
            output[3] = b3;
            output[2] = b2;
            output[1] = b1;
            output[0] = b0;
        }
    }
}
